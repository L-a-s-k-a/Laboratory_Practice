#include "init.h"

void GPIO_Ini_1(void){
    SET_BIT(RCC_GPIO_EN, RCC_GPIOB_EN | RCC_GPIOC_EN); // 开启GPIO B, GPIO C
    //  // 配置GPIOB为输出模式
    // GPIOB_MODER |= (GPIOB_MODE_PIN7_OUT | GPIOB_MODE_PIN0_OUT | GPIOB_MODE_PIN14_OUT | GPIOB_MODE_PIN8_OUT);
    // GPIOB_OTYPER |= (GPIOB_BSRR_PIN0_SET | GPIOB_BSRR_PIN7_SET | GPIOB_BSRR_PIN14_SET | GPIOB_BSRR_PIN8_SET);
    // GPIOB_OSPEEDR |= (GPIOB_BSRR_PIN0_SET | GPIOB_BSRR_PIN7_SET | GPIOB_BSRR_PIN14_SET | GPIOB_BSRR_PIN8_SET);
    // GPIOB_PUPDR |= 0x0; // 禁用上拉/下拉电阻

    SET_BIT(GPIOB_MODER, GPIOB_MODE_PIN7_OUT | GPIOB_MODE_PIN0_OUT | GPIOB_MODE_PIN14_OUT | GPIOB_MODE_PIN8_OUT); // 设置为输出模式
    SET_BIT(GPIOB_OTYPER, GPIOB_OTYPE_PIN7_PP | GPIOB_OTYPE_PIN0_PP | GPIOB_OTYPE_PIN14_PP | GPIOB_OTYPE_PIN8_PP); // 设置为推挽输出
    SET_BIT(GPIOB_OSPEEDR, GPIOB_OSPEED_PIN7_MID | GPIOB_OSPEED_PIN0_MID | GPIOB_OSPEED_PIN14_MID | GPIOB_OSPEED_PIN8_MID); // 设置速度为中等
    SET_BIT(GPIOB_PUPDR, GPIOB_PUPDR_PIN7_NOPUPD | GPIOB_PUPDR_PIN0_NOPUPD | GPIOB_PUPDR_PIN14_NOPUPD | GPIOB_PUPDR_PIN8_NOPUPD); // 禁用上拉/下拉电阻

    // 将PIN0设置为低电平，确保LED关闭
    GPIOB_BSRR = (0x0); // 复位所有引脚为低电平
    //GPIOB_BSRR = GPIOB_BSRR_PIN0_RESET | GPIOB_BSRR_PIN7_RESET | GPIOB_BSRR_PIN14_RESET | GPIOB_BSRR_PIN8_RESET; // 将PIN0复位为低电平
}

void GPIO_Ini_2(void) {
    GPIOC_IDR &= ~(GPIOC_IDR_PIN12 | GPIOC_IDR_PIN13 | GPIOC_IDR_PIN6);// 配置 GPIOC 端口（按钮的引脚）为输入模式
}

// 延时函数
void delay(uint32_t s) {
    while (s--) {
        for (volatile int i = 0; i < 1000; i++); // 精确延时
    }
}
